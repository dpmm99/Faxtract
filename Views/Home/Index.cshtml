@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    ViewData["Title"] = "Upload";
}

<div class="container">
    <div class="top-container">
        <form method="post" enctype="multipart/form-data" id="uploadForm">
            <div asp-validation-summary="All" class="text-danger"></div>
            <input type="file" name="files" accept=".txt" multiple />
            <div class="form-group mt-3">
                <label for="extraContext">Extra Context (Optional)</label>
                <textarea name="extraContext" id="extraContext" class="form-control" rows="3" placeholder="Add additional context for the LLM"></textarea>
                <small class="text-muted">This context will be provided to the AI to help generate more relevant flash cards.</small>
            </div>
            <button type="submit">Upload</button>
        </form>
        <div id="upload-status" class="mt-3"></div>

        <div class="status">
            <p>Processed: <span id="processed">0</span></p>
            <p>Remaining: <span id="remaining">0</span></p>
            <p>Tokens Generated: <span id="tokensGenerated">0</span></p>
            <p>Processing Speed: <span id="tokensPerSecond">-</span> tokens/sec</p>
        </div>
    </div>

    <div id="currentWork"></div>
    <br />
    <button onclick="testFileUploadsWithDifferentContexts()">Test with built-in data</button>
</div>

@section Scripts {
    <script src="~/lib/signalr/signalr.js"></script>
    <script src="~/js/home.js" asp-append-version="true"></script>
    <link href="~/css/home.css" rel="stylesheet" asp-append-version="true" />
    <script src="~/js/test.js" asp-append-version="true"></script>
}